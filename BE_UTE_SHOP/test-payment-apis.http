### ============================================
### ğŸ’³ PAYMENT APIs TEST - PAYOS INTEGRATION
### ============================================
### 
### HÆ°á»›ng dáº«n sá»­ dá»¥ng:
### 1. Thay {{userToken}} báº±ng token cá»§a báº¡n (láº¥y tá»« login)
### 2. Thay {{orderId}} báº±ng ID Ä‘Æ¡n hÃ ng thá»±c táº¿
### 3. Thay {{orderCode}} báº±ng order_code tá»« response táº¡o payment
###
### ============================================

### Variables
@baseUrl = http://localhost:5000/api
@userToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjcsImVtYWlsIjoibmd1eWVuaHV5cG0xQGdtYWlsLmNvbSIsInJvbGVJZCI6MSwiaWF0IjoxNzYxOTY5NDAzLCJleHAiOjE3NjI1NzQyMDN9.AkmseFTAzsuT3bvOsMPn_XSzt1HAxvIHgtxLo9-QC-4
@adminToken = YOUR_ADMIN_TOKEN_HERE
@orderId = 1
@orderCode = 1730468000000

### ============================================
### 1. Táº O PAYMENT LINK (Táº¡o link thanh toÃ¡n PayOS)
### ============================================
### YÃªu cáº§u: User pháº£i Ä‘Äƒng nháº­p vÃ  cÃ³ order há»£p lá»‡
###

POST {{baseUrl}}/payment/payos/create
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "order_id": {{orderId}}
}

###
### âœ… Response thÃ nh cÃ´ng:
### {
###   "success": true,
###   "message": "Táº¡o payment link thÃ nh cÃ´ng",
###   "data": {
###     "transaction_id": 1,
###     "payment_url": "https://pay.payos.vn/web/...",
###     "qr_code_url": "https://img.vietqr.io/...",
###     "order_code": 1730468000000,
###     "amount": 600000,
###     "expired_at": 1730469800
###   }
### }
###
### âŒ Lá»—i náº¿u:
### - Order khÃ´ng tá»“n táº¡i: 404
### - Order Ä‘Ã£ thanh toÃ¡n: 400
### - ChÆ°a Ä‘Äƒng nháº­p: 401
###

### ============================================
### 2. KIá»‚M TRA TRáº NG THÃI THANH TOÃN
### ============================================
### Public API - KhÃ´ng cáº§n token
### orderCode láº¥y tá»« response cá»§a API táº¡o payment
###

GET {{baseUrl}}/payment/payos/check/{{orderCode}}
Content-Type: application/json

###
### âœ… Response thÃ nh cÃ´ng:
### {
###   "success": true,
###   "message": "Láº¥y tráº¡ng thÃ¡i thanh toÃ¡n thÃ nh cÃ´ng",
###   "data": {
###     "transaction_id": 1,
###     "order_code": "1730468000000",
###     "status": "completed",
###     "amount": 600000,
###     "paid_at": "2024-11-01T10:35:00.000Z",
###     "payos_data": {
###       "status": "PAID",
###       "amount": 600000,
###       "transactionDateTime": "2024-11-01T10:35:00Z"
###     }
###   }
### }
###
### Status cÃ³ thá»ƒ lÃ :
### - pending: Chá» thanh toÃ¡n
### - processing: Äang xá»­ lÃ½
### - completed: ÄÃ£ thanh toÃ¡n thÃ nh cÃ´ng
### - failed: Thanh toÃ¡n tháº¥t báº¡i
### - cancelled: ÄÃ£ há»§y
###

### ============================================
### 3. Lá»ŠCH Sá»¬ THANH TOÃN Cá»¦A USER
### ============================================
### YÃªu cáº§u: User pháº£i Ä‘Äƒng nháº­p
###

GET {{baseUrl}}/payment/my-payments?page=1&limit=10
Content-Type: application/json
Authorization: Bearer {{userToken}}

###
### âœ… Response thÃ nh cÃ´ng:
### {
###   "success": true,
###   "message": "Láº¥y lá»‹ch sá»­ thanh toÃ¡n thÃ nh cÃ´ng",
###   "data": {
###     "transactions": [
###       {
###         "transaction_id": 1,
###         "order_id": 1,
###         "order_number": "UTE-2024-000001",
###         "amount": 600000,
###         "payment_status": "completed",
###         "paid_at": "2024-11-01T10:35:00.000Z",
###         "transaction_created_at": "2024-11-01T10:30:00.000Z"
###       }
###     ],
###     "pagination": {
###       "current_page": 1,
###       "per_page": 10,
###       "total": 5,
###       "total_pages": 1
###     }
###   }
### }
###

### ============================================
### 4. FILTER Lá»ŠCH Sá»¬ THEO STATUS
### ============================================
### Lá»c lá»‹ch sá»­ thanh toÃ¡n theo tráº¡ng thÃ¡i
###

GET {{baseUrl}}/payment/my-payments?status=completed&page=1&limit=10
Content-Type: application/json
Authorization: Bearer {{userToken}}

###
### Status values cÃ³ thá»ƒ dÃ¹ng:
### - pending: Chá» thanh toÃ¡n
### - processing: Äang xá»­ lÃ½
### - completed: ÄÃ£ thanh toÃ¡n thÃ nh cÃ´ng
### - failed: Thanh toÃ¡n tháº¥t báº¡i
### - cancelled: ÄÃ£ há»§y
### - refunded: ÄÃ£ hoÃ n tiá»n
###

### ============================================
### 5. WEBHOOK SIMULATION (MÃ´ phá»ng PayOS Webhook)
### ============================================
### API nÃ y Ä‘Æ°á»£c PayOS tá»± Ä‘á»™ng gá»i khi cÃ³ thay Ä‘á»•i tráº¡ng thÃ¡i thanh toÃ¡n
### Báº¡n cÃ³ thá»ƒ test báº±ng cÃ¡ch gá»i thá»§ cÃ´ng
###

POST {{baseUrl}}/payment/payos/webhook
Content-Type: application/json
X-Signature: test_signature

{
  "code": "00",
  "desc": "ThÃ nh cÃ´ng",
  "data": {
    "orderCode": "{{orderCode}}",
    "amount": 600000,
    "description": "Thanh toan don hang UTE-2024-000001",
    "accountNumber": "1234567890",
    "reference": "FT123456789",
    "transactionDateTime": "2024-11-01T10:35:00",
    "currency": "VND",
    "paymentLinkId": "abc123",
    "code": "00",
    "desc": "ThÃ nh cÃ´ng",
    "counterAccountBankId": "",
    "counterAccountBankName": "",
    "counterAccountName": "NGUYEN VAN A",
    "counterAccountNumber": "9876543210",
    "virtualAccountName": "",
    "virtualAccountNumber": ""
  },
  "signature": "test_signature"
}

###
### âœ… Response thÃ nh cÃ´ng:
### {
###   "success": true,
###   "message": "Webhook processed"
### }
###
### LÆ°u Ã½: Webhook nÃ y sáº½ tá»± Ä‘á»™ng:
### 1. Log vÃ o payment_webhooks table
### 2. Cáº­p nháº­t payment_transactions status
### 3. Cáº­p nháº­t orders: payment_status = 'paid', status_id = 2
###

### ============================================
### ğŸ”„ COMPLETE FLOW TEST - LUá»’NG THANH TOÃN HOÃ€N CHá»ˆNH
### ============================================

### BÆ°á»›c 1: User Ä‘Äƒng nháº­p
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "password123"
}

### â†’ LÆ°u token vÃ o biáº¿n {{userToken}}

###
### BÆ°á»›c 2: User táº¡o Ä‘Æ¡n hÃ ng (náº¿u chÆ°a cÃ³)
POST {{baseUrl}}/orders
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "items": [
    {
      "product_id": 1,
      "quantity": 2,
      "selected_color": "Äen",
      "selected_size": "L"
    }
  ],
  "shipping_address": {
    "full_name": "Nguyá»…n VÄƒn A",
    "phone": "0123456789",
    "address": "123 ÄÆ°á»ng ABC",
    "ward": "PhÆ°á»ng 1",
    "district": "Quáº­n 1",
    "city": "TP.HCM"
  },
  "billing_address": {
    "full_name": "Nguyá»…n VÄƒn A",
    "phone": "0123456789",
    "address": "123 ÄÆ°á»ng ABC",
    "ward": "PhÆ°á»ng 1",
    "district": "Quáº­n 1",
    "city": "TP.HCM"
  },
  "payment_method": "payos"
}

### â†’ LÆ°u order_id tá»« response

###
### BÆ°á»›c 3: User táº¡o payment link
POST {{baseUrl}}/payment/payos/create
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "order_id": {{orderId}}
}

### â†’ LÆ°u order_code vÃ  payment_url tá»« response
### â†’ Má»Ÿ payment_url trong browser Ä‘á»ƒ thanh toÃ¡n

###
### BÆ°á»›c 4: User thanh toÃ¡n táº¡i PayOS (external)
### â†’ Redirect Ä‘áº¿n PayOS website
### â†’ User thanh toÃ¡n
### â†’ PayOS redirect vá» Return URL

###
### BÆ°á»›c 5: PayOS gá»­i webhook vá» backend (automatic)
### â†’ PayOS tá»± Ä‘á»™ng gá»i webhook khi thanh toÃ¡n thÃ nh cÃ´ng
### â†’ Backend tá»± Ä‘á»™ng cáº­p nháº­t order vÃ  transaction

###
### BÆ°á»›c 6: User kiá»ƒm tra tráº¡ng thÃ¡i thanh toÃ¡n
GET {{baseUrl}}/payment/payos/check/{{orderCode}}
Content-Type: application/json

### â†’ Kiá»ƒm tra status = "completed"

###
### BÆ°á»›c 7: User xem lá»‹ch sá»­ thanh toÃ¡n
GET {{baseUrl}}/payment/my-payments?page=1&limit=10
Content-Type: application/json
Authorization: Bearer {{userToken}}

### â†’ Xem danh sÃ¡ch táº¥t cáº£ giao dá»‹ch

###
### BÆ°á»›c 8: User xem chi tiáº¿t Ä‘Æ¡n hÃ ng Ä‘Ã£ thanh toÃ¡n
GET {{baseUrl}}/orders/{{orderId}}
Content-Type: application/json
Authorization: Bearer {{userToken}}

### â†’ Kiá»ƒm tra payment_status = "paid"
###

### ============================================
### ğŸ’° HOÃ€N TIá»€N (REFUND) - API Má»šI
### ============================================
### YÃªu cáº§u: ÄÆ¡n hÃ ng Ä‘Ã£ thanh toÃ¡n thÃ nh cÃ´ng (payment_status = 'paid')
### LÆ°u Ã½: Vá»›i cháº¿ Ä‘á»™ spending mode cá»§a PayOS, khi há»§y Ä‘Æ¡n hÃ ng Ä‘Ã£ thanh toÃ¡n,
### PayOS sáº½ tá»± Ä‘á»™ng hoÃ n tiá»n vá» tÃ i khoáº£n khÃ¡ch hÃ ng
###

POST {{baseUrl}}/payment/refund
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "order_id": {{orderId}},
  "amount": 600000,
  "reason": "Há»§y Ä‘Æ¡n hÃ ng theo yÃªu cáº§u khÃ¡ch hÃ ng"
}

###
### âœ… Response thÃ nh cÃ´ng:
### {
###   "success": true,
###   "message": "YÃªu cáº§u hoÃ n tiá»n Ä‘Ã£ Ä‘Æ°á»£c gá»­i thÃ nh cÃ´ng",
###   "data": {
###     "refund_id": 1,
###     "refund_amount": 600000,
###     "transaction_id": 1,
###     "payos_refund_id": "refund_abc123",
###     "status": "processing"
###   }
### }
###
### âŒ Lá»—i náº¿u:
### - Order khÃ´ng tá»“n táº¡i: 404
### - Order chÆ°a thanh toÃ¡n: 400 - "Chá»‰ cÃ³ thá»ƒ hoÃ n tiá»n cho Ä‘Æ¡n hÃ ng Ä‘Ã£ thanh toÃ¡n"
### - ÄÃ£ refund rá»“i: 400 - "ÄÆ¡n hÃ ng Ä‘Ã£ Ä‘Æ°á»£c hoÃ n tiá»n"
### - Sá»‘ tiá»n refund lá»›n hÆ¡n sá»‘ tiá»n Ä‘Ã£ thanh toÃ¡n: 400
###

### ============================================
### ğŸ’° HOÃ€N TIá»€N TOÃ€N Bá»˜ (KhÃ´ng chá»‰ Ä‘á»‹nh amount)
### ============================================

POST {{baseUrl}}/payment/refund
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "order_id": {{orderId}},
  "reason": "HoÃ n tiá»n toÃ n bá»™ Ä‘Æ¡n hÃ ng"
}

###
### â†’ Náº¿u khÃ´ng cÃ³ amount, sáº½ refund toÃ n bá»™ sá»‘ tiá»n Ä‘Ã£ thanh toÃ¡n
###

### ============================================
### ğŸ”„ Há»¦Y PAYMENT TRANSACTION
### ============================================
### Há»§y payment link chÆ°a thanh toÃ¡n
###

POST {{baseUrl}}/payment/cancel
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "transaction_id": 1
}

###
### âœ… Response thÃ nh cÃ´ng:
### {
###   "success": true,
###   "message": "Há»§y thanh toÃ¡n thÃ nh cÃ´ng",
###   "data": {
###     "transaction_id": 1,
###     "status": "cancelled"
###   }
### }
###
### âŒ Lá»—i náº¿u:
### - Transaction khÃ´ng tá»“n táº¡i: 404
### - Transaction Ä‘Ã£ completed: 400 - "KhÃ´ng thá»ƒ há»§y giao dá»‹ch vá»›i tráº¡ng thÃ¡i completed"
### - Transaction khÃ´ng thuá»™c vá» user: 404
###

### ============================================
### ğŸ”„ RETRY PAYMENT - Táº O Láº I PAYMENT LINK
### ============================================
### Táº¡o láº¡i payment link cho Ä‘Æ¡n hÃ ng payment failed hoáº·c cancelled
###

POST {{baseUrl}}/payment/retry
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "order_id": {{orderId}}
}

###
### âœ… Response thÃ nh cÃ´ng:
### {
###   "success": true,
###   "message": "Táº¡o payment link thÃ nh cÃ´ng",
###   "data": {
###     "transaction_id": 2,
###     "payment_url": "https://pay.payos.vn/web/...",
###     "qr_code_url": "https://img.vietqr.io/...",
###     "order_code": 1234567890
###   }
### }
###
### âŒ Lá»—i náº¿u:
### - Order khÃ´ng tá»“n táº¡i: 404
### - Order payment_status lÃ  'paid': 400
###

### ============================================
### ğŸ›’ Há»¦Y ÄÆ N HÃ€NG (Vá»šI AUTO REFUND)
### ============================================
### Khi há»§y Ä‘Æ¡n hÃ ng Ä‘Ã£ thanh toÃ¡n qua PayOS, há»‡ thá»‘ng sáº½ tá»± Ä‘á»™ng refund
###

POST {{baseUrl}}/orders/{{orderId}}/cancel
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "reason": "KhÃ´ng cÃ²n muá»‘n mua ná»¯a"
}

###
### âœ… Response thÃ nh cÃ´ng (náº¿u Ä‘Ã£ thanh toÃ¡n):
### {
###   "success": true,
###   "message": "Há»§y Ä‘Æ¡n hÃ ng thÃ nh cÃ´ng. YÃªu cáº§u hoÃ n tiá»n Ä‘Ã£ Ä‘Æ°á»£c gá»­i.",
###   "data": {
###     "refund": {
###       "refund_id": 1,
###       "payos_refund_id": "refund_abc123",
###       "amount": 600000,
###       "status": "processing"
###     }
###   }
### }
###
### âœ… Response thÃ nh cÃ´ng (náº¿u chÆ°a thanh toÃ¡n):
### {
###   "success": true,
###   "message": "Há»§y Ä‘Æ¡n hÃ ng thÃ nh cÃ´ng"
### }
###
### âŒ Lá»—i náº¿u:
### - Order khÃ´ng tá»“n táº¡i: 404
### - Order Ä‘Ã£ Ä‘Æ°á»£c xá»­ lÃ½ (status_id > 2 vÃ  chÆ°a thanh toÃ¡n): 400
### - Order khÃ´ng thuá»™c vá» user: 403
###
### LÆ°u Ã½:
### - Náº¿u Ä‘Æ¡n hÃ ng Ä‘Ã£ thanh toÃ¡n (payment_status = 'paid') vÃ  payment_method = 'payos',
###   há»‡ thá»‘ng sáº½ tá»± Ä‘á»™ng táº¡o refund request vÃ  gá»i PayOS refund API
### - Vá»›i cháº¿ Ä‘á»™ spending mode cá»§a PayOS, tiá»n sáº½ tá»± Ä‘á»™ng hoÃ n vá» tÃ i khoáº£n khÃ¡ch hÃ ng
### - Tá»“n kho sáº£n pháº©m sáº½ Ä‘Æ°á»£c hoÃ n láº¡i tá»± Ä‘á»™ng
###

### ============================================
### ğŸ“‹ LUá»’NG TEST HOÃ€N CHá»ˆNH: THANH TOÃN â†’ Há»¦Y â†’ REFUND
### ============================================
###
### BÆ°á»›c 1: Táº¡o Ä‘Æ¡n hÃ ng
### POST {{baseUrl}}/orders
### â†’ LÆ°u order_id
###
### BÆ°á»›c 2: Táº¡o payment link
### POST {{baseUrl}}/payment/payos/create
### â†’ LÆ°u order_code vÃ  payment_url
###
### BÆ°á»›c 3: Thanh toÃ¡n táº¡i PayOS (external)
### â†’ Má»Ÿ payment_url trong browser
### â†’ Thanh toÃ¡n thÃ nh cÃ´ng
###
### BÆ°á»›c 4: Kiá»ƒm tra tráº¡ng thÃ¡i thanh toÃ¡n
### GET {{baseUrl}}/payment/payos/check/{{orderCode}}
### â†’ Kiá»ƒm tra status = "completed", payment_status = "paid"
###
### BÆ°á»›c 5: Há»§y Ä‘Æ¡n hÃ ng (tá»± Ä‘á»™ng refund)
### POST {{baseUrl}}/orders/{{orderId}}/cancel
### â†’ Há»‡ thá»‘ng tá»± Ä‘á»™ng:
###   - Táº¡o refund record
###   - Gá»i PayOS refund API
###   - Cáº­p nháº­t transaction status = 'refunded'
###   - Cáº­p nháº­t order payment_status = 'refunded'
###   - HoÃ n láº¡i tá»“n kho
###
### BÆ°á»›c 6: Kiá»ƒm tra refund status
### GET {{baseUrl}}/payment/my-payments?status=refunded
### â†’ Xem refund Ä‘Ã£ Ä‘Æ°á»£c xá»­ lÃ½ chÆ°a
###
### BÆ°á»›c 7 (Alternative): Refund thá»§ cÃ´ng
### POST {{baseUrl}}/payment/refund
### â†’ Náº¿u muá»‘n refund thá»§ cÃ´ng thay vÃ¬ há»§y Ä‘Æ¡n hÃ ng
###

### ============================================
### âŒ ERROR SCENARIOS - TEST CÃC TRÆ¯á»œNG Há»¢P Lá»–I
### ============================================

### Test 1: Táº¡o payment cho order khÃ´ng tá»“n táº¡i
POST {{baseUrl}}/payment/payos/create
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "order_id": 99999
}

### â†’ Expected: 404 Not Found

###
### Test 2: Táº¡o payment khÃ´ng cÃ³ token
POST {{baseUrl}}/payment/payos/create
Content-Type: application/json

{
  "order_id": 1
}

### â†’ Expected: 401 Unauthorized

###
### Test 3: Táº¡o payment cho order cá»§a user khÃ¡c
POST {{baseUrl}}/payment/payos/create
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "order_id": 999
}

### â†’ Expected: 404 Not Found (khÃ´ng tÃ¬m tháº¥y order cá»§a user nÃ y)

###
### Test 4: Táº¡o payment cho order Ä‘Ã£ thanh toÃ¡n
POST {{baseUrl}}/payment/payos/create
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "order_id": 1
}

### â†’ Expected: 400 Bad Request - "ÄÆ¡n hÃ ng Ä‘Ã£ Ä‘Æ°á»£c thanh toÃ¡n"

###
### Test 5: Kiá»ƒm tra order code khÃ´ng tá»“n táº¡i
GET {{baseUrl}}/payment/payos/check/999999999999
Content-Type: application/json

### â†’ Expected: 404 Not Found

###
### Test 6: Láº¥y lá»‹ch sá»­ thanh toÃ¡n khÃ´ng cÃ³ token
GET {{baseUrl}}/payment/my-payments?page=1&limit=10
Content-Type: application/json

### â†’ Expected: 401 Unauthorized

###
### Test 7: Táº¡o payment vá»›i body thiáº¿u order_id
POST {{baseUrl}}/payment/payos/create
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "invalid_field": 1
}

### â†’ Expected: 404 hoáº·c 400 (tÃ¹y validation)

###
### Test 8: Refund Ä‘Æ¡n hÃ ng chÆ°a thanh toÃ¡n
POST {{baseUrl}}/payment/refund
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "order_id": {{orderId}}
}

### â†’ Expected: 400 Bad Request - "Chá»‰ cÃ³ thá»ƒ hoÃ n tiá»n cho Ä‘Æ¡n hÃ ng Ä‘Ã£ thanh toÃ¡n"

###
### Test 9: Refund Ä‘Æ¡n hÃ ng khÃ´ng tá»“n táº¡i
POST {{baseUrl}}/payment/refund
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "order_id": 99999
}

### â†’ Expected: 404 Not Found - "KhÃ´ng tÃ¬m tháº¥y Ä‘Æ¡n hÃ ng"

###
### Test 10: Refund Ä‘Æ¡n hÃ ng Ä‘Ã£ refund
### (Cháº¡y sau khi Ä‘Ã£ refund láº§n 1)
POST {{baseUrl}}/payment/refund
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "order_id": {{orderId}}
}

### â†’ Expected: 400 Bad Request - "ÄÆ¡n hÃ ng Ä‘Ã£ Ä‘Æ°á»£c hoÃ n tiá»n"

###
### Test 11: Refund vá»›i sá»‘ tiá»n lá»›n hÆ¡n sá»‘ tiá»n Ä‘Ã£ thanh toÃ¡n
POST {{baseUrl}}/payment/refund
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "order_id": {{orderId}},
  "amount": 999999999
}

### â†’ Expected: 400 Bad Request - "Sá»‘ tiá»n hoÃ n tráº£ khÃ´ng Ä‘Æ°á»£c lá»›n hÆ¡n sá»‘ tiá»n Ä‘Ã£ thanh toÃ¡n"

###
### Test 12: Há»§y payment transaction khÃ´ng tá»“n táº¡i
POST {{baseUrl}}/payment/cancel
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "transaction_id": 99999
}

### â†’ Expected: 404 Not Found - "KhÃ´ng tÃ¬m tháº¥y giao dá»‹ch"

###
### Test 13: Há»§y payment Ä‘Ã£ completed
POST {{baseUrl}}/payment/cancel
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "transaction_id": 1
}

### â†’ Expected: 400 Bad Request - "KhÃ´ng thá»ƒ há»§y giao dá»‹ch vá»›i tráº¡ng thÃ¡i completed"

###
### Test 14: Retry payment cho Ä‘Æ¡n hÃ ng Ä‘Ã£ paid
POST {{baseUrl}}/payment/retry
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "order_id": {{orderId}}
}

### â†’ Expected: 400 Bad Request - "KhÃ´ng thá»ƒ táº¡o láº¡i payment link cho Ä‘Æ¡n hÃ ng vá»›i tráº¡ng thÃ¡i paid"

###
### Test 15: Há»§y Ä‘Æ¡n hÃ ng khÃ´ng tá»“n táº¡i
POST {{baseUrl}}/orders/99999/cancel
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "reason": "Test"
}

### â†’ Expected: 404 Not Found - "KhÃ´ng tÃ¬m tháº¥y Ä‘Æ¡n hÃ ng"

###
### Test 16: Há»§y Ä‘Æ¡n hÃ ng Ä‘Ã£ Ä‘Æ°á»£c xá»­ lÃ½ (Ä‘Ã£ gá»­i Ä‘i)
POST {{baseUrl}}/orders/{{orderId}}/cancel
Content-Type: application/json
Authorization: Bearer {{userToken}}

{
  "reason": "Test"
}

### â†’ Expected: 400 Bad Request - "KhÃ´ng thá»ƒ há»§y Ä‘Æ¡n hÃ ng Ä‘Ã£ Ä‘Æ°á»£c xá»­ lÃ½"
### (Náº¿u order.status_id > 2 vÃ  payment_status != 'paid')

###

